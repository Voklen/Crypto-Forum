use crate::{custom_types::Message, *};

#[test]
fn read() {
	let test_file = "reference/reference.json";
	let (file_slice, parser) = read::read_file_data(test_file).unwrap();
	let stuff = read_serde::get_messages(&file_slice, &parser).unwrap();
	let expected = [
		Message {
			prev_hash: [
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0,
			],
			public_key: ed25519_dalek::PublicKey::from_bytes(&[
				40, 151, 31, 122, 201, 208, 88, 167, 131, 68, 167, 174, 137, 226, 120, 246, 76, 47,
				160, 112, 83, 73, 250, 195, 91, 192, 40, 220, 255, 12, 254, 77,
			])
			.unwrap(),
			message: "hello".to_string(),
			signed: true,
			hash: [
				23, 189, 24, 38, 108, 90, 212, 238, 197, 124, 125, 252, 172, 131, 189, 160, 150,
				146, 57, 248, 122, 37, 169, 26, 54, 148, 253, 214, 156, 86, 84, 48, 213, 126, 169,
				110, 112, 193, 139, 171, 86, 28, 176, 254, 96, 7, 144, 162, 111, 100, 223, 91, 123,
				169, 69, 168, 29, 52, 236, 123, 77, 16, 200, 149,
			],
		},
		Message {
			prev_hash: [
				23, 189, 24, 38, 108, 90, 212, 238, 197, 124, 125, 252, 172, 131, 189, 160, 150,
				146, 57, 248, 122, 37, 169, 26, 54, 148, 253, 214, 156, 86, 84, 48, 213, 126, 169,
				110, 112, 193, 139, 171, 86, 28, 176, 254, 96, 7, 144, 162, 111, 100, 223, 91, 123,
				169, 69, 168, 29, 52, 236, 123, 77, 16, 200, 149,
			],
			public_key: ed25519_dalek::PublicKey::from_bytes(&[
				40, 151, 31, 122, 201, 208, 88, 167, 131, 68, 167, 174, 137, 226, 120, 246, 76, 47,
				160, 112, 83, 73, 250, 195, 91, 192, 40, 220, 255, 12, 254, 77,
			])
			.unwrap(),
			message: "hi".to_string(),
			signed: false,
			hash: [
				44, 227, 198, 209, 35, 116, 193, 127, 137, 140, 215, 159, 84, 75, 95, 172, 217,
				111, 75, 178, 53, 101, 104, 228, 201, 18, 108, 2, 42, 154, 25, 80, 91, 160, 119,
				222, 173, 213, 48, 17, 250, 233, 245, 112, 24, 202, 156, 220, 167, 103, 142, 79,
				42, 149, 182, 18, 161, 141, 41, 53, 99, 119, 81, 2,
			],
		},
		Message {
			prev_hash: [
				44, 227, 198, 209, 35, 116, 193, 127, 137, 140, 215, 159, 84, 75, 95, 172, 217,
				111, 75, 178, 53, 101, 104, 228, 201, 18, 108, 2, 42, 154, 25, 80, 91, 160, 119,
				222, 173, 213, 48, 17, 250, 233, 245, 112, 24, 202, 156, 220, 167, 103, 142, 79,
				42, 149, 182, 18, 161, 141, 41, 53, 99, 119, 81, 2,
			],
			public_key: ed25519_dalek::PublicKey::from_bytes(&[
				40, 151, 31, 122, 201, 208, 88, 167, 131, 68, 167, 174, 137, 226, 120, 246, 76, 47,
				160, 112, 83, 73, 250, 195, 91, 192, 40, 220, 255, 12, 254, 77,
			])
			.unwrap(),
			message: "indeed".to_string(),
			signed: true,
			hash: [
				2, 251, 94, 134, 28, 55, 212, 188, 1, 215, 195, 39, 32, 245, 202, 80, 4, 7, 139,
				77, 101, 82, 216, 94, 128, 100, 242, 115, 120, 167, 235, 79, 33, 91, 8, 73, 110,
				28, 29, 129, 250, 147, 26, 106, 75, 45, 192, 67, 2, 250, 219, 224, 150, 148, 37,
				160, 206, 208, 171, 213, 197, 94, 67, 133,
			],
		},
	];
	assert_eq!(stuff, expected.to_vec());
}
